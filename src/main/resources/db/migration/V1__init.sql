create table public.dish_ingredients(
                                 dish_id bigint not null,
                                 ingredient_id bigint not null);

create table public.dish_orders(
                            id bigint not null,
                            amount bigint,
                            dish_id bigint
);

ALTER TABLE public.dish_orders ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.dish_orders_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

create table dishes(
                       id bigint not null,
                       name character varying(255),
                       price double precision
);

ALTER TABLE public.dishes ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.dishes_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

create table drink_orders(
                             id bigint not null,
                             amount bigint,
                             drink_id bigint
);

ALTER TABLE public.drink_orders ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.drink_orders_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

CREATE TABLE public.drinks (
                        id bigint NOT NULL,
                        name character varying(255),
                        price double precision
);

ALTER TABLE public.drinks ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.drinks_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

CREATE TABLE public.excluded_dish_ingredients (
                                                  dish_order_id bigint NOT NULL,
                                                  ingredient_id bigint NOT NULL
);

CREATE TABLE public.ingredients (
                                    id bigint NOT NULL,
                                    name character varying(255)
);

ALTER TABLE public.ingredients ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.ingredients_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

CREATE TABLE public.orders (
                               id bigint NOT NULL,
                               status integer
);

CREATE TABLE public.orders_dishes (
                                      order_id bigint NOT NULL,
                                      dishes_id bigint NOT NULL
);

CREATE TABLE public.orders_drinks (
                                      order_id bigint NOT NULL,
                                      drinks_id bigint NOT NULL
);

ALTER TABLE public.orders ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.orders_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

CREATE TABLE public.roles (
                              id bigint NOT NULL,
                              created_at timestamp without time zone,
                              status character varying(255),
                              updated_at timestamp without time zone,
                              name character varying(255)
);

ALTER TABLE public.roles ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.roles_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

CREATE TABLE public.user_roles (
                                   user_id bigint NOT NULL,
                                   role_id bigint NOT NULL
);

CREATE TABLE public.users (
                              id bigint NOT NULL,
                              created_at timestamp without time zone,
                              status character varying(255),
                              updated_at timestamp without time zone,
                              email character varying(255),
                              first_name character varying(255),
                              last_name character varying(255),
                              password character varying(255),
                              username character varying(255)
);

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
START WITH 1
          INCREMENT BY 1
          NO MINVALUE
          NO MAXVALUE
          CACHE 1
          );

COPY public.roles (id, created_at, status, updated_at, name) FROM stdin;
1	2021-08-28 20:43:35	ACTIVE	2021-08-28 20:43:41	ROLE_USER
2	2021-08-28 20:43:35	ACTIVE	2021-08-28 20:43:41	ROLE_ADMIN
3	2021-08-28 20:43:35	ACTIVE	2021-08-28 20:43:41	ROLE_COOK
\.

COPY public.user_roles (user_id, role_id) FROM stdin;
1	1
1	2
1	3
\.

COPY public.users (id, created_at, status, updated_at, email, first_name, last_name, password, username) FROM stdin;
1	2021-08-28 20:44:56.942104	ACTIVE	2021-08-28 20:44:56.942104	test@email.com	\N	\N	$2a$10$3jHQnfbFomLLndXbfbyq3.Jim/teSU9.E1fRp/rl5XEmPK.lETn0e	k4rnaj1k
\.

SELECT pg_catalog.setval('public.dish_orders_id_seq', 1, false);


SELECT pg_catalog.setval('public.dishes_id_seq', 1, false);


SELECT pg_catalog.setval('public.drink_orders_id_seq', 1, false);


SELECT pg_catalog.setval('public.drinks_id_seq', 1, false);


SELECT pg_catalog.setval('public.ingredients_id_seq', 1, false);


SELECT pg_catalog.setval('public.orders_id_seq', 1, false);


SELECT pg_catalog.setval('public.roles_id_seq', 1, false);


SELECT pg_catalog.setval('public.users_id_seq', 1, true);

ALTER TABLE ONLY public.dish_orders
    ADD CONSTRAINT dish_orders_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.dishes
    ADD CONSTRAINT dishes_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.drink_orders
    ADD CONSTRAINT drink_orders_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.drinks
    ADD CONSTRAINT drinks_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.ingredients
    ADD CONSTRAINT ingredients_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.orders
    ADD CONSTRAINT orders_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.users
    ADD CONSTRAINT email_unique UNIQUE (email);

ALTER TABLE ONLY public.dishes
    ADD CONSTRAINT name_unique UNIQUE (name);

ALTER TABLE ONLY public.ingredients
    ADD CONSTRAINT ingredient_name_unique UNIQUE (name);

ALTER TABLE ONLY public.orders_dishes
    ADD CONSTRAINT order_dish_id_unique UNIQUE (dishes_id);

ALTER TABLE ONLY public.orders_drinks
    ADD CONSTRAINT drink_id_unique UNIQUE (drinks_id);

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.drink_orders
    ADD CONSTRAINT drink_fk FOREIGN KEY (drink_id) REFERENCES public.drinks(id);

ALTER TABLE ONLY public.orders_dishes
    ADD CONSTRAINT order_fk FOREIGN KEY (order_id) REFERENCES public.orders(id);

ALTER TABLE ONLY public.orders_drinks
    ADD CONSTRAINT drink_fk FOREIGN KEY (drinks_id) REFERENCES public.drink_orders(id);

ALTER TABLE ONLY public.orders_drinks
    ADD CONSTRAINT order_drink_id_fk FOREIGN KEY (order_id) REFERENCES public.orders(id);

ALTER TABLE ONLY public.dish_ingredients
    ADD CONSTRAINT dish_fk FOREIGN KEY (dish_id) REFERENCES public.dishes(id);

ALTER TABLE ONLY public.dish_ingredients
    ADD CONSTRAINT dish_ingredient_fk FOREIGN KEY (ingredient_id) REFERENCES public.ingredients(id);

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT role_id_fk FOREIGN KEY (role_id) REFERENCES public.roles(id);

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT user_id_fk FOREIGN KEY (user_id) REFERENCES public.users(id);

ALTER TABLE ONLY public.excluded_dish_ingredients
    ADD CONSTRAINT dish_order_id_fk FOREIGN KEY (dish_order_id) REFERENCES public.dish_orders(id);

ALTER TABLE ONLY public.excluded_dish_ingredients
    ADD CONSTRAINT ingredient_id_fk FOREIGN KEY (ingredient_id) REFERENCES public.ingredients(id);

ALTER TABLE ONLY public.dish_orders
    ADD CONSTRAINT dish_id_fk FOREIGN KEY (dish_id) REFERENCES public.dishes(id);

ALTER TABLE ONLY public.orders_dishes
    ADD CONSTRAINT order_dish_id_fk FOREIGN KEY (dishes_id) REFERENCES public.dish_orders(id);
